<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Avaliação de Aluno</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/avaliacao.css' %}?v=1.0" />
    <link rel="icon" href="{% static 'favicon.ico' %}" type="image/x-icon" />
  </head>
  <body>
    <div class="container">
      <!-- Barra lateral -->
      <div class="sidebar">
        <h2>Menu</h2>
        <ul>
          <li><a href="{% url 'pagina_inicial' %}">Início</a></li>
          <li><a href="{% url 'lista_estudantes' %}">Estudantes</a></li>
          <li><a href="{% url 'lista_professores' %}">Professores</a></li>
          <li><a href="{% url 'lista_classes' %}">Chamada</a></li>
          <li><a href="{% url 'lista_aulas' %}">Aulas</a></li>
          <li><a href="{% url 'avaliacao' %}" class="active">Avaliação</a></li>
        </ul>
      </div>

      <!-- Conteúdo principal -->
      <div class="main-content">
        <h1>Avaliação de Aluno</h1>

        <main>
          <!-- Formulário de Avaliação -->
          <form method="POST">
            {% csrf_token %}
            <div class="form-group">
              <label for="classe">Selecione a Classe:</label>
              <select
                id="classe"
                name="classe"
                required
                onchange="filtrarEstudantesProfessores()"
              >
                <option value="" disabled selected>Selecione uma classe</option>
                {% for classe in classes %} 
                  <option value="{{ classe.id }}" {% if classe.id == request.GET.idclasse|stringformat:"s" %}selected{% endif %}>
    {{ classe.classe }}
</option>
                {% endfor %}
              </select>
            </div>

            <div class="form-group">
              <label for="estudante">Selecione o Estudante:</label> 
              <select id="estudante" name="estudante" required>
                {% for estudante in estudantes %}
                  <option value="{{ estudante.id }}">{{ estudante.nome }}</option>
                {% endfor %}
              </select>
            </div>

            <div class="form-group">
              <label for="professor">Selecione o Professor:</label>
              <select id="professor" name="professor" required>
                {% for professor in professores %}
                  <option value="{{ professor.id }}">
                    {{ professor.nome }}
                  </option>
                {% endfor %}
              </select>
            </div>

            <!-- Tabela para matérias -->
        <div class="materias-container">
          <h3>Matérias do Aluno Selecionado</h3>
          <table>
            <thead>
              <tr>
                <th>Matéria</th>
                <th>Professor</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              {% for aula in aulas %}
                  <tr>
                    <td>{{ aula.nome }}</td>
                    <td>{{ aluno.descricao }}</td>
                    <td>{{ status }} </td>
                  </tr>
                {% endfor %}
                <tr>
                  <td colspan="3">Nenhuma matéria associada ao aluno selecionado.</td>
                </tr>
            </tbody>
          </table>
        </div>

            <!-- Comentários Gerais -->
            <div class="form-group">
              <label for="general-comments">Comentários Gerais:</label>
              <textarea
                id="general-comments"
                name="general-comments"
                placeholder="Adicione comentários gerais sobre o aluno."
              ></textarea>
            </div>

            <!-- Botão Salvar -->
            <button type="submit" class="btn">Salvar Avaliação</button>
          </form>
        </main>
      </div>
    </div>

    <script>
      function filtrarEstudantesProfessores() {
        var classeId = document.getElementById("classe").value;
        if (classeId) {
            // Altere para usar idclasse
            window.location.href = "/avaliacao/?idclasse=" + classeId;
        }
    }
    </script>
  </body>
</html>
